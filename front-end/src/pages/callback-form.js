import Head from 'next/head';
import CallbackForm from '~/components/CallbackForm/';
import Background from '~/components/Background';
import LampLightAnimation from '~/components/Background/LampLightAnimation';
import Bath from '~/components/Background/Bath';
import House from '~/components/Background/House';
import Kitchen from '~/components/Background/Kitchen';
import useWindowWidth from '~/hooks/useWindowWidth';
import { useEffect, useState } from 'react';

export default function GetAQuote() {
  const windowWidth = useWindowWidth();
  const [ faviconHref, setFaviconHref ] = useState('');

  useEffect(() => {
    if (typeof window !== 'undefined') {
      const setFavicon = (color) => {
        const favicon = document.getElementById('favicon');
        favicon.href = `favicon-${ color }.svg`;
        setFaviconHref(`favicon-${ color }.svg`);
      };

      const handleColorSchemeChange = (e) => {
        const colorScheme = e.matches ? 'light' : 'dark';
        setFavicon(colorScheme);
      };

      const colorSchemeQuery = window.matchMedia('(prefers-color-scheme: dark)');
      colorSchemeQuery.addListener(handleColorSchemeChange);
      handleColorSchemeChange(colorSchemeQuery);

      return () => {
        colorSchemeQuery.removeListener(handleColorSchemeChange);
      };
    }
  }, []);
  return (
    <>
      <Head>
        <title>Get a quote</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href={ faviconHref } id="favicon" type="image/x-icon" />
      </Head>
      <main>
        <CallbackForm />
      </main>
      <Background>
        {windowWidth >= 1440 ? <LampLightAnimation top="-9.5%" left="31%" /> : null}
        <LampLightAnimation
          left={ windowWidth >= 1440 ? '62%' : windowWidth >= 768 ? '65%' : '71%' }
          top={ windowWidth >= 1440 ? '-9.5%' : windowWidth >= 768 ? '-12%' : '-13%' }
        />
        {windowWidth >= 768
          ? (
            <Bath
              bottom={ windowWidth >= 1440 ? '16%' : windowWidth >= 768 ? '8%' : '8%' }
              left={ windowWidth >= 1440 ? '6%' : windowWidth >= 768 ? '82%' : '66%' }
              width={ windowWidth >= 1440 ? '154' : '104' }
              height={ windowWidth >= 1440 ? '140' : '94' }
            />
          ) : null}
        {windowWidth >= 1440 ? <House bottom="15%" left="83%" width="201" height="201" /> : null}
        {windowWidth >= 768
          ? (
            <Kitchen
              bottom={ windowWidth >= 1440 ? '35%' : windowWidth >= 768 ? '7%' : '8%' }
              left={ windowWidth >= 1440 ? '83%' : windowWidth >= 768 ? '10%' : '8%' }
              width={ windowWidth >= 1440 ? '127' : '103' }
              height={ windowWidth >= 1440 ? '133' : '109' }
            />
          ) : null}
      </Background>
    </>
  );
}
